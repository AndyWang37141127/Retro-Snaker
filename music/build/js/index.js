var songSource,$=window.Zepto,root=window.player,index=0,audioControl=new root.audioControl;function bindEvent(){$("body").on("play:change",function(o,n){audioControl.getAudio(songSource[n].audio),root.process.renderAlltime(songSource[n].duration),root.render(songSource[n]),root.process.update(0),"play"==audioControl.status&&(audioControl.play(),root.process.start())}),$(".control").on("click",".play-btn",function(){"play"==audioControl.status?(audioControl.pause(),root.process.stop()):(audioControl.play(),root.process.start()),$(this).toggleClass("playing")}),$(".control").on("click",".prev-btn",function(){var o=controlManager.prev();window.index=o,root.render(songSource[o]),$("body").trigger("play:change",o)}),$(".control").on("click",".next-btn",function(){var o=controlManager.next();window.index=o,root.render(songSource[o]),$("body").trigger("play:change",o)})}function bindTouch(){var r=0,e=$(".pro-wrapper").offset();$(".slider-pointer").on("touchstart",function(o){root.process.stop()}).on("touchmove",function(o){var n=o.changedTouches[0].clientX;1<(r=(n-e.left)/e.width)?r=1:r<0&&(r=0),root.process.update(r)}).on("touchend",function(o){var n=o.changedTouches[0].clientX;1<(r=(n-e.left)/e.width)?(r=0,$(".next-btn").trigger("click")):r<0&&(r=0);var t=r*songSource[index].duration;audioControl.playTo(t),root.process.start(r),$(".play-btn").addClass("playing"),audioControl.status="play"})}function getData(o){$.ajax({type:"GET",url:o,success:function(o){root.render(o[0]),songSource=o,bindEvent(),bindTouch(),controlManager=new root.controlManager(o.length),audioControl.getAudio(o[0].audio),root.process.renderAlltime(o[0].duration)},error:function(){}})}getData("../mock/data.json");